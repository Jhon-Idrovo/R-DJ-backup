(this["webpackJsonphome-finance-api"]=this["webpackJsonphome-finance-api"]||[]).push([[0],{107:function(e,t,s){},108:function(e,t,s){},109:function(e,t,s){},110:function(e,t,s){},111:function(e,t,s){},206:function(e,t,s){},207:function(e,t,s){"use strict";s.r(t);var a=s(1),c=s.n(a),n=s(68),i=s.n(n),o=(s(78),s(4)),r=(s(79),s(5)),l=s(2),j=s(17),u=s(8),d=s(6),b=s(0);var h=function(){var e=Object(l.f)(),t=Object.freeze({username:"",password:""}),s=Object(a.useState)(t),c=Object(o.a)(s,2),n=c[0],i=c[1],h=function(e){i(Object(u.a)(Object(u.a)({},n),{},Object(j.a)({},e.target.name,e.target.value)))};return Object(a.useEffect)((function(){}),[]),Object(b.jsx)("div",{className:"form-container",children:Object(b.jsxs)("form",{className:"form",children:[Object(b.jsx)("h3",{className:"form-title",children:"REGISTRO"}),Object(b.jsx)("input",{type:"email",name:"email",id:"email",placeholder:"Email",onChange:h}),Object(b.jsx)("input",{type:"text",name:"username",id:"username",placeholder:"Nombre de usuario",onChange:h}),Object(b.jsx)("input",{type:"password",name:"password",id:"password",placeholder:"Contrase\xf1a",onChange:h}),Object(b.jsx)("input",{type:"submit",value:"Crear Cuenta",className:"submit-btn",onClick:function(t){t.preventDefault(),d.a.post("api/register/",n).then((function(t){console.log(t),e.push("/login/")})).catch((function(e){console.log(e)}))}}),Object(b.jsxs)("p",{children:["Ya tienes una cuenta? ",Object(b.jsx)(r.b,{to:"/login",children:"Ingresa aqu\xed"})]})]})})};var p=function(){return Object(b.jsx)("div",{className:"message-container",children:Object(b.jsxs)("div",{className:"message-box",children:[Object(b.jsx)("h3",{className:"message-header",children:"Vaya!"}),Object(b.jsxs)("p",{children:["Parece que no te has autentificado, por favor",Object(b.jsx)(r.b,{to:"login/",children:" ingresa aqu\xed"})]})]})})};s(107),s(108);var O=function(e){var t=e.exp;return Object(b.jsx)(b.Fragment,{children:Object(b.jsxs)("tr",{children:[Object(b.jsx)("td",{children:t.date}),Object(b.jsx)("td",{children:t.exp_type}),Object(b.jsx)("td",{children:t.description}),Object(b.jsx)("td",{children:t.amount})]},t.id)})};s(109);var x=function(){return Object(b.jsx)("div",{className:"message-container",children:Object(b.jsxs)("div",{className:"message-box",children:[Object(b.jsx)("div",{className:"spinner"}),Object(b.jsx)("p",{children:"Cargando..."})]})})};var m=function(){return Object(b.jsx)("div",{className:"message-container",children:Object(b.jsxs)("div",{className:"message-box",children:[Object(b.jsx)("h3",{className:"message-header",children:"Vaya!"}),Object(b.jsx)("p",{children:'Parece que eres nuev@ por aqu\xed, comienza introduciendo algunos gastos en la secci\xf3n "Registrar Gasto"'})]})})};s(110);var f=function(){return Object(b.jsx)("div",{className:"message-container",children:Object(b.jsxs)("div",{className:"message-box",children:[Object(b.jsx)("h3",{className:"message-header",children:"Disculpas"}),Object(b.jsx)("p",{children:"Parece que hubo un error con nuestros servidores, estamos trabajando para solucionarlo lo antes posible"})]})})};var g=function(e){var t=e.isLoged,s=Object(a.useState)(null),c=Object(o.a)(s,2),n=c[0],i=c[1],r=Object(a.useState)(!0),l=Object(o.a)(r,2),j=l[0],u=l[1];if(Object(a.useEffect)((function(){d.a.get("api/all-expenses/").then((function(e){if(200!==e.status)throw f();i(e.data),u(!1)})).catch((function(e){console.log(e),u(!1)}))}),[]),!t)return Object(b.jsx)(p,{});if(j)return Object(b.jsx)(x,{});try{if(0===n.length)return Object(b.jsx)(m,{})}catch(h){return console.log(h),Object(b.jsx)(f,{})}return Object(b.jsxs)("table",{children:[Object(b.jsx)("thead",{children:Object(b.jsxs)("tr",{children:[Object(b.jsx)("th",{children:"Fecha"}),Object(b.jsx)("th",{children:"Tipo"}),Object(b.jsx)("th",{children:"Descripci\xf3n"}),Object(b.jsx)("th",{children:"Monto"})]})}),Object(b.jsx)("tbody",{children:n.map((function(e){return Object(b.jsx)(O,{exp:e})}))})]})};var v=function(e){var t=e.setIsLoged,s=Object(l.f)(),c=localStorage.getItem("refresh_token");return Object(a.useEffect)((function(){d.a.post("api/logout/",{refresh_token:c}).then((function(e){202==e.status&&(localStorage.removeItem("access_token"),d.a.defaults.headers.Authorization=null,t(!1),s.push("/login/"))}))}),[]),Object(b.jsx)("div",{})};var N=function(e){e.isLoged;var t=e.setIsLoged,s=Object(l.f)(),c=Object.freeze({username:"",password:""}),n=Object(a.useState)(c),i=Object(o.a)(n,2),h=i[0],p=i[1],O=function(e){p(Object(u.a)(Object(u.a)({},h),{},Object(j.a)({},e.target.name,e.target.value)))};return Object(b.jsx)("div",{className:"form-container",children:Object(b.jsxs)("form",{className:"form",children:[Object(b.jsx)("h3",{className:"form-title",children:"INGRESO"}),Object(b.jsx)("input",{type:"text",name:"username",id:"username",placeholder:"Nombre de usuario",onChange:O}),Object(b.jsx)("input",{type:"password",name:"password",id:"password",placeholder:"Contrase\xf1a",onChange:O}),Object(b.jsx)("input",{type:"submit",value:"Ingresar",className:"submit-btn",onClick:function(e){e.preventDefault(),d.a.post("/api/token/",h).then((function(e){if(200===e.status){var a=e.data;localStorage.setItem("access_token",a.access),localStorage.setItem("refresh_token",a.refresh),d.a.defaults.headers.Authorization="JWT "+a.access,t(!0),s.push("/create-expense/")}}))}}),Object(b.jsxs)("p",{children:["No tienes una cuenta? ",Object(b.jsx)(r.b,{to:"/register",children:"Registrate aqu\xed"})]})]})})},k=s(73);var C=function(e){var t=e.handleChange,s=e.exp,a=e.index;return Object(b.jsxs)("tr",{className:"exp-row",children:[Object(b.jsx)("td",{className:"type-entry",children:Object(b.jsx)("input",{type:"text",list:"expensesList",onChange:function(e){return t(e,e.target.name,"expType")},value:s.expType,placeholder:"Tipo",name:a})}),Object(b.jsx)("td",{className:"description-entry",children:Object(b.jsx)("input",{type:"text",value:s.description,onChange:function(e){return t(e,e.target.name,"description")},placeholder:"Descripci\xf3n",name:a,list:s.expType})}),Object(b.jsx)("td",{className:"amount-entry",children:Object(b.jsx)("input",{type:"number",value:s.amount,onChange:function(e){return t(e,e.target.name,"amount")},placeholder:"0.00",name:a})})]})},S=(s(111),{expType:"",description:"",amount:""});var y=function(e){var t=e.isLoged,s=Object(a.useState)([JSON.parse(JSON.stringify(S))]),c=Object(o.a)(s,2),n=c[0],i=c[1],r=function(e,t,s){console.log("handling change"+s+t);var a=Object.assign([],n);console.log(a),a[parseInt(t)][s]=e.target.value,i(a),console.log(n)};return t?Object(b.jsxs)("div",{className:"exp-container",children:[Object(b.jsxs)("form",{id:"expenses-form",children:[Object(b.jsxs)("table",{children:[Object(b.jsx)("thead",{children:Object(b.jsxs)("tr",{className:"head-row",children:[Object(b.jsx)("th",{className:"table-headers",children:"Tipo"}),Object(b.jsx)("th",{className:"table-headers",children:"Descripci\xf3n"}),Object(b.jsx)("th",{className:"table-headers",children:"Monto"})]})}),Object(b.jsx)("tbody",{id:"table-body",children:n.map((function(e,t){return Object(b.jsx)(C,{handleChange:r,exp:e,index:t},t)}))}),Object(b.jsx)("tfoot",{children:Object(b.jsx)("button",{id:"add-btn",onClick:function(e){e.preventDefault(),i([].concat(Object(k.a)(n),[JSON.parse(JSON.stringify(S))]))},children:"A\xf1adir fila"})})]}),Object(b.jsx)("div",{id:"submit-container",children:Object(b.jsx)("input",{type:"submit",value:"Guardar",onClick:function(e){e.preventDefault(),d.a.post("api/save-expenses/",n).then((function(e){if(console.log(e),200!=e.status)throw Error;i([Object(u.a)({},S)])})).catch((function(e){console.log(e)}))},className:"exp-submit-btn"})})]}),Object(b.jsxs)("datalist",{id:"expensesList",children:[Object(b.jsx)("option",{value:"Alimentaci\xf3n",hidden:!0}),Object(b.jsx)("option",{value:"Farmacia"}),Object(b.jsx)("option",{value:"Servicios b\xe1sicos"}),Object(b.jsx)("option",{value:"Vestimenta"}),Object(b.jsx)("option",{value:"Ocio(Entreteniemiento en general)"}),Object(b.jsx)("option",{value:"Mascotas"}),Object(b.jsx)("option",{value:"Donaciones"}),Object(b.jsx)("option",{value:"Otros"})]}),Object(b.jsxs)("datalist",{id:"Alimentaci\xf3n",children:[Object(b.jsx)("option",{className:"Food",value:"Carne"}),Object(b.jsx)("option",{className:"Food",value:"Legumbres"}),Object(b.jsx)("option",{className:"Food",value:"Huevos"}),Object(b.jsx)("option",{className:"Food",value:"Vegetales"}),Object(b.jsx)("option",{className:"Food",value:"Frutas"})]}),Object(b.jsxs)("datalist",{id:"Vestimenta",children:[Object(b.jsx)("option",{value:"Camisas/Blusas",className:"Clothes"}),Object(b.jsx)("option",{value:"Zapatos",className:"Clothes"}),Object(b.jsx)("option",{value:"Pantalones",className:"Clothes"}),Object(b.jsx)("option",{value:"Abrigos",className:"Clothes"}),Object(b.jsx)("option",{value:"Adornos",className:"Clothes"})]}),Object(b.jsxs)("datalist",{id:"Servicios b\xe1sicos",children:[Object(b.jsx)("option",{className:"BasicServices",value:"Agua Potable"}),Object(b.jsx)("option",{className:"BasicServices",value:"Energ\xeda El\xe9ctrica"}),Object(b.jsx)("option",{className:"BasicServices",value:"Internet"}),Object(b.jsx)("option",{className:"BasicServices",value:"Gas"}),Object(b.jsx)("option",{className:"BasicServices",value:""})]}),Object(b.jsxs)("datalist",{id:"Mascotas",children:[Object(b.jsx)("option",{value:"Comida",className:"Pets"}),Object(b.jsx)("option",{value:"Accesorios",className:"Pets"}),Object(b.jsx)("option",{value:"Farmacia",className:"Pets"})]}),Object(b.jsxs)("datalist",{id:"Ocio(Entreteniemiento en general)",children:[Object(b.jsx)("option",{value:"Viajes",className:"Leisure"}),Object(b.jsx)("option",{value:"Pel\xedculas",className:"Leisure"}),Object(b.jsx)("option",{value:"Videojuegos",className:"Leisure"}),Object(b.jsx)("option",{value:"Juguetes varios",className:"Leisure"}),Object(b.jsx)("option",{value:"",className:"Leisure"})]})]}):Object(b.jsx)(p,{})},w=s(72),L=(s(206),{scales:{xAxes:[{stacked:!0}],yAxes:[{stacked:!0}]}}),I=(new Date).toLocaleDateString("en-US").split("/"),F=Object(o.a)(I,3),T=F[0],A=F[1],E=F[2];var D=function(e){var t=e.isLoged,s=Object(a.useState)(null),c=Object(o.a)(s,2),n=c[0],i=c[1],r=Object(a.useState)({init:"".concat(E-1,"-").concat(T<10?"0"+T:T,"-").concat(A<10?"0"+A:A),end:"".concat(E,"-").concat(T<10?"0"+T:T,"-").concat(A<10?"0"+A:A)}),l=Object(o.a)(r,2),j=l[0],h=l[1];Object(a.useEffect)((function(){O()}),[]);var O=function(){d.a.post("api/statistics/",j).then((function(e){var t={labels:[1,2,3,4,5,6,7],datasets:[]},s=e.data.series;s.forEach((function(e){e.backgroundColor="#"+("00000"+(Math.random()*(1<<24)|0).toString(16)).slice(-6)})),t.datasets=s,t.labels=e.data.labels,i(t)}))};return t?Object(b.jsxs)("div",{children:[Object(b.jsx)(w.Line,{data:n,options:L}),Object(b.jsxs)("form",{className:"stats-form",children:[Object(b.jsxs)("span",{id:"dates-container",children:[Object(b.jsxs)("span",{className:"date",children:[Object(b.jsx)("label",{htmlFor:"initial-date",children:"Fecha Inicio"}),Object(b.jsx)("input",{type:"date",name:"initial",id:"initial-date",value:j.init,onChange:function(e){h(Object(u.a)(Object(u.a)({},j),{},{init:e.target.value}))}})]}),Object(b.jsxs)("span",{className:"date",children:[Object(b.jsx)("label",{htmlFor:"end-date",children:"Fecha Final"}),Object(b.jsx)("input",{type:"date",name:"end",id:"end-date",value:j.end,onChange:function(e){h(Object(u.a)(Object(u.a)({},j),{},{end:e.target.value}))}})]})]}),Object(b.jsx)("input",{type:"submit",value:"Cargar",onClick:function(e){e.preventDefault(),O()},id:"submit-btn"})]})]}):Object(b.jsx)(p,{})};var P=function(){var e=Object(a.useState)(Boolean(localStorage.getItem("access_token"))),t=Object(o.a)(e,2),s=t[0],c=t[1];return Object(b.jsxs)(r.a,{children:[Object(b.jsxs)("nav",{children:[Object(b.jsxs)("div",{id:"first-line",children:[Object(b.jsx)("label",{className:"logo",children:"Home Finance"}),Object(b.jsxs)("ul",{id:"extras",children:[Object(b.jsx)("li",{className:"list-item",children:s?Object(b.jsx)(r.c,{to:"/logout",className:"upper-btn",activeClassName:"upper-active",children:"Logout"}):Object(b.jsx)(r.c,{to:"/login",className:"upper-btn",activeClassName:"upper-active",children:"Login"})}),Object(b.jsx)("li",{className:"list-item",children:Object(b.jsx)(r.c,{to:"/config",className:"upper-btn",activeClassName:"upper-active",children:Object(b.jsx)("i",{className:"fas fa-cog"})})})]})]}),Object(b.jsxs)("ul",{children:[Object(b.jsx)("li",{className:"list-item",children:Object(b.jsx)(r.c,{to:"/create-expense",children:"Registrar Gasto"})}),Object(b.jsx)("li",{className:"list-item",children:Object(b.jsx)(r.c,{to:"/statistics",children:"Estad\xedsticas"})}),Object(b.jsx)("li",{className:"list-item",children:Object(b.jsx)(r.c,{to:"/book",children:"Gastos"})})]})]}),Object(b.jsxs)(l.c,{children:[Object(b.jsx)(l.a,{path:"/create-expense",children:Object(b.jsx)(y,{isLoged:s})}),Object(b.jsx)(l.a,{path:"/statistics",children:Object(b.jsx)(D,{isLoged:s})}),Object(b.jsx)(l.a,{path:"/book",children:Object(b.jsx)(g,{isLoged:s})}),Object(b.jsx)(l.a,{path:"/login",children:Object(b.jsx)(N,{isLoged:s,setIsLoged:c})}),Object(b.jsx)(l.a,{path:"/register",children:Object(b.jsx)(h,{})}),Object(b.jsx)(l.a,{path:"/logout",children:Object(b.jsx)(v,{setIsLoged:c})})]})]})},_=function(e){e&&e instanceof Function&&s.e(3).then(s.bind(null,208)).then((function(t){var s=t.getCLS,a=t.getFID,c=t.getFCP,n=t.getLCP,i=t.getTTFB;s(e),a(e),c(e),n(e),i(e)}))};i.a.render(Object(b.jsx)(c.a.StrictMode,{children:Object(b.jsx)(P,{})}),document.getElementById("root")),_()},6:function(e,t,s){"use strict";(function(e){var a=s(40),c=s.n(a),n=s(69),i=s(70),o="http://127.0.0.1:8000/",r=s.n(i).a.create({baseURL:o,timeout:5e3,headers:{Authorization:localStorage.getItem("access_token")?"JWT "+localStorage.getItem("access_token"):null,"Content-Type":"application/json",accept:"application/json"}});r.interceptors.response.use((function(e){return e}),function(){var t=Object(n.a)(c.a.mark((function t(s){var a,n,i,l;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=s.config,"undefined"!==typeof s.response){t.next=4;break}return alert("A server/network error occurred. Looks like CORS might be the problem. Sorry about this - we will get it fixed shortly."),t.abrupt("return",Promise.reject(s));case 4:if(401!==s.response.status||a.url!==o+"/api/token/refresh/"){t.next=7;break}return window.location.href="/login/",t.abrupt("return",Promise.reject(s));case 7:if("token_not_valid"!==s.response.data.code||401!==s.response.status||"Unauthorized"!==s.response.statusText){t.next=23;break}if(console.log("making a new refresh token"),!(n=localStorage.getItem("refresh_token"))){t.next=21;break}if(i=JSON.parse(e.from(n.split(".")[1],"base64").toString()),l=Math.ceil(Date.now()/1e3),!(i.exp>l)){t.next=17;break}return t.abrupt("return",r.post("/api/token/refresh/",{refresh:n}).then((function(e){return console.log(e.data),localStorage.setItem("access_token",e.data.access),r.defaults.headers.Authorization="JWT "+e.data.access,a.headers.Authorization="JWT "+e.data.access,r(a)})).catch((function(e){console.log(e)})));case 17:console.log("Refresh token is expired",i.exp,l),window.location.href="/login/";case 19:t.next=23;break;case 21:console.log("Refresh token not available."),window.location.href="/login/";case 23:return t.abrupt("return",Promise.reject(s));case 24:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),t.a=r}).call(this,s(80).Buffer)},78:function(e,t,s){},79:function(e,t,s){}},[[207,1,2]]]);
//# sourceMappingURL=main.301ba141.chunk.js.map